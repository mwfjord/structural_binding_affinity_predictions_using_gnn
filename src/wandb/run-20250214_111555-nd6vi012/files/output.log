Using GPU
/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/dataset.py:184: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  data = torch.load(os.path.join(self.processed_dir,
Training:   0%|                                                                                                                                                                                                                              | 0/18 [00:00<?, ?it/s]/home/marcus/miniconda3/envs/gnn/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:224: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
                                                                                                                                                                                                                                                                    
Epoch 10: Train Loss = 4.3823, Val Loss = 4.0574
Epoch 20: Train Loss = 2.3483, Val Loss = 2.5119
Epoch 30: Train Loss = 2.1705, Val Loss = 2.3548
Epoch 40: Train Loss = 2.5337, Val Loss = 2.3570
Epoch 50: Train Loss = 2.2518, Val Loss = 2.3220
Epoch 60: Train Loss = 2.0571, Val Loss = 2.3681
Epoch 70: Train Loss = 2.2786, Val Loss = 2.3937
Epoch 80: Train Loss = 2.6167, Val Loss = 2.6484
Epoch 90: Train Loss = 2.2331, Val Loss = 2.5281
Epoch 100: Train Loss = 2.1731, Val Loss = 2.3708
Epoch 110: Train Loss = 2.1048, Val Loss = 2.3773
Epoch 120: Train Loss = 1.9901, Val Loss = 2.5996
Epoch 130: Train Loss = 1.8903, Val Loss = 2.6161
Epoch 140: Train Loss = 1.9332, Val Loss = 2.5602
Epoch 150: Train Loss = 1.8270, Val Loss = 2.5472
Epoch 160: Train Loss = 2.5325, Val Loss = 2.3748
Epoch 170: Train Loss = 2.0349, Val Loss = 2.6461
Epoch 180: Train Loss = 2.0484, Val Loss = 2.5523
Epoch 190: Train Loss = 1.9505, Val Loss = 2.6344
Epoch 200: Train Loss = 1.9588, Val Loss = 2.5781
Epoch 210: Train Loss = 1.8766, Val Loss = 2.6226
Epoch 220: Train Loss = 1.9430, Val Loss = 2.5662
Epoch 230: Train Loss = 1.7769, Val Loss = 2.6267
Epoch 240: Train Loss = 1.9712, Val Loss = 2.6834
Epoch 250: Train Loss = 1.6803, Val Loss = 2.7425
Epoch 260: Train Loss = 1.7464, Val Loss = 2.7687
Epoch 270: Train Loss = 1.6024, Val Loss = 2.8693
Epoch 280: Train Loss = 1.5501, Val Loss = 2.8273
Epoch 290: Train Loss = 1.5055, Val Loss = 2.8733
Epoch 300: Train Loss = 1.6573, Val Loss = 2.8704
Epoch 310: Train Loss = 1.6148, Val Loss = 2.8854
Epoch 320: Train Loss = 2.0536, Val Loss = 2.5651
Epoch 330: Train Loss = 1.8251, Val Loss = 2.9740
Epoch 340: Train Loss = 1.7814, Val Loss = 2.5803
Epoch 350: Train Loss = 1.6799, Val Loss = 2.8998
Epoch 360: Train Loss = 1.7742, Val Loss = 3.1188
Epoch 370: Train Loss = 1.7367, Val Loss = 2.7646
Epoch 380: Train Loss = 1.5687, Val Loss = 2.7481
Epoch 390: Train Loss = 1.4995, Val Loss = 2.7979
Epoch 400: Train Loss = 1.5591, Val Loss = 2.8025
Epoch 410: Train Loss = 1.4931, Val Loss = 2.9665
Epoch 420: Train Loss = 1.7119, Val Loss = 3.3736
Epoch 430: Train Loss = 1.6679, Val Loss = 2.8571
Epoch 440: Train Loss = 1.4048, Val Loss = 2.9402
Epoch 450: Train Loss = 1.2259, Val Loss = 2.8809
Epoch 460: Train Loss = 1.2030, Val Loss = 3.1195
Epoch 470: Train Loss = 1.2058, Val Loss = 2.8874
Epoch 480: Train Loss = 1.0294, Val Loss = 2.9606
Epoch 490: Train Loss = 1.0227, Val Loss = 3.1744
Epoch 500: Train Loss = 0.9244, Val Loss = 3.3120
Epoch 510: Train Loss = 0.9078, Val Loss = 3.4575
Epoch 520: Train Loss = 0.9987, Val Loss = 3.4495
Epoch 530: Train Loss = 0.8278, Val Loss = 3.4354
Epoch 540: Train Loss = 0.7522, Val Loss = 3.5493
Epoch 550: Train Loss = 0.7745, Val Loss = 3.5040
Epoch 560: Train Loss = 0.6639, Val Loss = 3.5708
Epoch 570: Train Loss = 0.6586, Val Loss = 3.6948
Epoch 580: Train Loss = 0.6417, Val Loss = 3.7022
Epoch 590: Train Loss = 0.5948, Val Loss = 3.7201
Epoch 600: Train Loss = 0.5630, Val Loss = 3.7508
Epoch 610: Train Loss = 0.5610, Val Loss = 3.7622
Epoch 620: Train Loss = 0.5635, Val Loss = 3.7567
Epoch 630: Train Loss = 0.5557, Val Loss = 3.7610
Epoch 640: Train Loss = 1.1058, Val Loss = 3.2885
Epoch 650: Train Loss = 1.2447, Val Loss = 2.8693
Epoch 660: Train Loss = 1.2802, Val Loss = 3.3764
Epoch 670: Train Loss = 0.9813, Val Loss = 3.8291
Epoch 680: Train Loss = 1.0374, Val Loss = 3.4438
Epoch 690: Train Loss = 1.0147, Val Loss = 3.0639
Epoch 700: Train Loss = 1.1419, Val Loss = 3.1332
Epoch 710: Train Loss = 1.1017, Val Loss = 3.0561
Epoch 720: Train Loss = 1.0411, Val Loss = 3.0745
Epoch 730: Train Loss = 0.9073, Val Loss = 2.9032
Epoch 740: Train Loss = 1.1417, Val Loss = 3.0823
Epoch 750: Train Loss = 0.8078, Val Loss = 3.2094
Epoch 760: Train Loss = 0.9216, Val Loss = 3.4729
Epoch 770: Train Loss = 0.7592, Val Loss = 2.9986
Epoch 780: Train Loss = 0.8147, Val Loss = 3.2225
Epoch 790: Train Loss = 0.8824, Val Loss = 3.4701
Epoch 800: Train Loss = 0.9773, Val Loss = 3.1948
Epoch 810: Train Loss = 0.6406, Val Loss = 2.8909
Epoch 820: Train Loss = 0.6073, Val Loss = 3.2719
Epoch 830: Train Loss = 0.7137, Val Loss = 3.1701
Epoch 840: Train Loss = 0.6019, Val Loss = 3.2665
Epoch 850: Train Loss = 0.5145, Val Loss = 3.1302
Epoch 860: Train Loss = 0.7956, Val Loss = 3.1569
Epoch 870: Train Loss = 0.5979, Val Loss = 3.1266
Epoch 880: Train Loss = 0.4919, Val Loss = 3.4133
Epoch 890: Train Loss = 0.4356, Val Loss = 3.0672
Epoch 900: Train Loss = 0.4487, Val Loss = 3.4598
Epoch 910: Train Loss = 0.4440, Val Loss = 3.1502
Epoch 920: Train Loss = 0.4564, Val Loss = 3.0121
Epoch 930: Train Loss = 0.4090, Val Loss = 3.1743
Epoch 940: Train Loss = 0.3498, Val Loss = 3.4485
Epoch 950: Train Loss = 0.4471, Val Loss = 2.9586
Epoch 960: Train Loss = 0.3966, Val Loss = 3.2384
Epoch 970: Train Loss = 0.4395, Val Loss = 3.0807
Epoch 980: Train Loss = 0.2860, Val Loss = 3.1391
Epoch 990: Train Loss = 0.3586, Val Loss = 3.1106
Epoch 1000: Train Loss = 0.2914, Val Loss = 3.1172
Epoch 1010: Train Loss = 0.2578, Val Loss = 3.2321
Epoch 1020: Train Loss = 0.3227, Val Loss = 3.1129
Epoch 1030: Train Loss = 0.2549, Val Loss = 3.0840
Epoch 1040: Train Loss = 0.2068, Val Loss = 3.0740
Epoch 1050: Train Loss = 0.1895, Val Loss = 3.1817
Epoch 1060: Train Loss = 0.2376, Val Loss = 3.1187
Epoch 1070: Train Loss = 0.1470, Val Loss = 3.1554
Epoch 1080: Train Loss = 0.1693, Val Loss = 3.1358
Epoch 1090: Train Loss = 0.1306, Val Loss = 3.1137
Epoch 1100: Train Loss = 0.1610, Val Loss = 3.1571
Epoch 1110: Train Loss = 0.1222, Val Loss = 3.0952
Epoch 1120: Train Loss = 0.0964, Val Loss = 3.1525
Epoch 1130: Train Loss = 0.0896, Val Loss = 3.1664
Epoch 1140: Train Loss = 0.0750, Val Loss = 3.1435
Epoch 1150: Train Loss = 0.0596, Val Loss = 3.1571
Epoch 1160: Train Loss = 0.0483, Val Loss = 3.1663
Epoch 1170: Train Loss = 0.0411, Val Loss = 3.1446
Epoch 1180: Train Loss = 0.0491, Val Loss = 3.1708
Epoch 1190: Train Loss = 0.0239, Val Loss = 3.1634
Epoch 1200: Train Loss = 0.0228, Val Loss = 3.1518
Epoch 1210: Train Loss = 0.0225, Val Loss = 3.1611
Epoch 1220: Train Loss = 0.0133, Val Loss = 3.1710
Epoch 1230: Train Loss = 0.0092, Val Loss = 3.1675
Epoch 1240: Train Loss = 0.0066, Val Loss = 3.1710
Epoch 1250: Train Loss = 0.0047, Val Loss = 3.1697
Epoch 1260: Train Loss = 0.0036, Val Loss = 3.1716
Epoch 1270: Train Loss = 0.0034, Val Loss = 3.1716
Epoch 1280: Train Loss = 0.6096, Val Loss = 3.0738
Epoch 1290: Train Loss = 0.6609, Val Loss = 3.4169
Epoch 1300: Train Loss = 0.5889, Val Loss = 3.0076
Epoch 1310: Train Loss = 0.5510, Val Loss = 2.8831
Epoch 1320: Train Loss = 0.6462, Val Loss = 2.8234
Epoch 1330: Train Loss = 0.5939, Val Loss = 2.8184
Epoch 1340: Train Loss = 0.7073, Val Loss = 2.8394
Epoch 1350: Train Loss = 0.7230, Val Loss = 3.0884
Epoch 1360: Train Loss = 0.7188, Val Loss = 2.9525
Epoch 1370: Train Loss = 0.7080, Val Loss = 3.3318
Epoch 1380: Train Loss = 0.5090, Val Loss = 3.2604
Epoch 1390: Train Loss = 0.5062, Val Loss = 2.8744
Epoch 1400: Train Loss = 0.6169, Val Loss = 2.9949
Epoch 1410: Train Loss = 0.6460, Val Loss = 2.7779
Epoch 1420: Train Loss = 0.5617, Val Loss = 2.8071
Epoch 1430: Train Loss = 0.5487, Val Loss = 2.8275
Epoch 1440: Train Loss = 0.5455, Val Loss = 2.6839
Epoch 1450: Train Loss = 0.5961, Val Loss = 2.9072
Epoch 1460: Train Loss = 0.4967, Val Loss = 2.6998
Epoch 1470: Train Loss = 0.5291, Val Loss = 2.7455
Epoch 1480: Train Loss = 0.5030, Val Loss = 2.9727
Epoch 1490: Train Loss = 0.6265, Val Loss = 2.6731
Epoch 1500: Train Loss = 0.5563, Val Loss = 2.9499
Epoch 1510: Train Loss = 0.4968, Val Loss = 3.1176
Epoch 1520: Train Loss = 0.5429, Val Loss = 2.7417
Epoch 1530: Train Loss = 0.4033, Val Loss = 2.9698
Epoch 1540: Train Loss = 0.4804, Val Loss = 3.0336
Epoch 1550: Train Loss = 0.4894, Val Loss = 2.8541
Epoch 1560: Train Loss = 0.4364, Val Loss = 2.7454
Epoch 1570: Train Loss = 0.4489, Val Loss = 2.9891
Epoch 1580: Train Loss = 0.4182, Val Loss = 2.9100
Epoch 1590: Train Loss = 0.3891, Val Loss = 2.9734
Epoch 1600: Train Loss = 0.4098, Val Loss = 2.6813
Epoch 1610: Train Loss = 0.3396, Val Loss = 2.7722
Epoch 1620: Train Loss = 0.5174, Val Loss = 2.7625
Epoch 1630: Train Loss = 0.4300, Val Loss = 2.7277
Epoch 1640: Train Loss = 0.4786, Val Loss = 2.7098
Epoch 1650: Train Loss = 0.4384, Val Loss = 2.6883
Epoch 1660: Train Loss = 0.4504, Val Loss = 2.8116
Epoch 1670: Train Loss = 0.3530, Val Loss = 2.7299
Epoch 1680: Train Loss = 0.4773, Val Loss = 2.6876
Epoch 1690: Train Loss = 0.3733, Val Loss = 2.7339
Epoch 1700: Train Loss = 0.4149, Val Loss = 2.6562
Epoch 1710: Train Loss = 0.3558, Val Loss = 2.8218
Epoch 1720: Train Loss = 0.3844, Val Loss = 2.6771
Epoch 1730: Train Loss = 0.3256, Val Loss = 2.7275
Epoch 1740: Train Loss = 0.3811, Val Loss = 2.8668
Epoch 1750: Train Loss = 0.3253, Val Loss = 2.7464
Epoch 1760: Train Loss = 0.2625, Val Loss = 2.6202
Epoch 1770: Train Loss = 0.3428, Val Loss = 2.7911
Epoch 1780: Train Loss = 0.3056, Val Loss = 2.6484
Epoch 1790: Train Loss = 0.3060, Val Loss = 2.6403
Epoch 1800: Train Loss = 0.2783, Val Loss = 2.6365
Epoch 1810: Train Loss = 0.3193, Val Loss = 2.7502
Epoch 1820: Train Loss = 0.2860, Val Loss = 2.6624
Epoch 1830: Train Loss = 0.2444, Val Loss = 2.6704
Epoch 1840: Train Loss = 0.2759, Val Loss = 2.6547
Epoch 1850: Train Loss = 0.3404, Val Loss = 2.6456
Epoch 1860: Train Loss = 0.2703, Val Loss = 2.6026
Epoch 1870: Train Loss = 0.2755, Val Loss = 2.6245
Epoch 1880: Train Loss = 0.2625, Val Loss = 2.6082
Epoch 1890: Train Loss = 0.2663, Val Loss = 2.6932
Epoch 1900: Train Loss = 0.2861, Val Loss = 2.5872
Epoch 1910: Train Loss = 0.2820, Val Loss = 2.5674
Epoch 1920: Train Loss = 0.2098, Val Loss = 2.6605
Epoch 1930: Train Loss = 0.2663, Val Loss = 2.6532
Epoch 1940: Train Loss = 0.2518, Val Loss = 2.6481
Epoch 1950: Train Loss = 0.2099, Val Loss = 2.5635
Epoch 1960: Train Loss = 0.1908, Val Loss = 2.5867
Epoch 1970: Train Loss = 0.2221, Val Loss = 2.6059
Epoch 1980: Train Loss = 0.1713, Val Loss = 2.6306
Epoch 1990: Train Loss = 0.1721, Val Loss = 2.6355
Epoch 2000: Train Loss = 0.1720, Val Loss = 2.6973
Epoch 2010: Train Loss = 0.1644, Val Loss = 2.6005
Epoch 2020: Train Loss = 0.1823, Val Loss = 2.7251
Epoch 2030: Train Loss = 0.1621, Val Loss = 2.6879
Epoch 2040: Train Loss = 0.1713, Val Loss = 2.5686
Epoch 2050: Train Loss = 0.1586, Val Loss = 2.6681
Epoch 2060: Train Loss = 0.1524, Val Loss = 2.5787
Epoch 2070: Train Loss = 0.1418, Val Loss = 2.5752
Epoch 2080: Train Loss = 0.1479, Val Loss = 2.5996
Epoch 2090: Train Loss = 0.1190, Val Loss = 2.6048
Epoch 2100: Train Loss = 0.1518, Val Loss = 2.6770
Epoch 2110: Train Loss = 0.1424, Val Loss = 2.6261
Epoch 2120: Train Loss = 0.1162, Val Loss = 2.6064
Epoch 2130: Train Loss = 0.1154, Val Loss = 2.6264
Epoch 2140: Train Loss = 0.1003, Val Loss = 2.6033
Epoch 2150: Train Loss = 0.1091, Val Loss = 2.5994
Epoch 2160: Train Loss = 0.0890, Val Loss = 2.6096
Epoch 2170: Train Loss = 0.0910, Val Loss = 2.5894
Epoch 2180: Train Loss = 0.0893, Val Loss = 2.5668
Epoch 2190: Train Loss = 0.0807, Val Loss = 2.6132
Epoch 2200: Train Loss = 0.0755, Val Loss = 2.6054
Epoch 2210: Train Loss = 0.0639, Val Loss = 2.5951
Epoch 2220: Train Loss = 0.0698, Val Loss = 2.6334
Epoch 2230: Train Loss = 0.0664, Val Loss = 2.5991
Epoch 2240: Train Loss = 0.0735, Val Loss = 2.6130
Epoch 2250: Train Loss = 0.0703, Val Loss = 2.5982
Epoch 2260: Train Loss = 0.0642, Val Loss = 2.5903
Epoch 2270: Train Loss = 0.0527, Val Loss = 2.5860
Epoch 2280: Train Loss = 0.0535, Val Loss = 2.6123
Epoch 2290: Train Loss = 0.0450, Val Loss = 2.5906
Epoch 2300: Train Loss = 0.0423, Val Loss = 2.6012
Epoch 2310: Train Loss = 0.0365, Val Loss = 2.6054
Epoch 2320: Train Loss = 0.0387, Val Loss = 2.6081
Epoch 2330: Train Loss = 0.0352, Val Loss = 2.6102
Epoch 2340: Train Loss = 0.0366, Val Loss = 2.6036
Epoch 2350: Train Loss = 0.0233, Val Loss = 2.6003
Epoch 2360: Train Loss = 0.0269, Val Loss = 2.6099
Epoch 2370: Train Loss = 0.0260, Val Loss = 2.6158
Epoch 2380: Train Loss = 0.0187, Val Loss = 2.6071
Epoch 2390: Train Loss = 0.0195, Val Loss = 2.6047
Epoch 2400: Train Loss = 0.0164, Val Loss = 2.6016
Epoch 2410: Train Loss = 0.0133, Val Loss = 2.6118
Epoch 2420: Train Loss = 0.0126, Val Loss = 2.6137
Epoch 2430: Train Loss = 0.0122, Val Loss = 2.6030
Epoch 2440: Train Loss = 0.0109, Val Loss = 2.6108
Epoch 2450: Train Loss = 0.0085, Val Loss = 2.6065
Epoch 2460: Train Loss = 0.0065, Val Loss = 2.6075
Epoch 2470: Train Loss = 0.0071, Val Loss = 2.6098
Epoch 2480: Train Loss = 0.0048, Val Loss = 2.6072
Epoch 2490: Train Loss = 0.0041, Val Loss = 2.6075
Epoch 2500: Train Loss = 0.0036, Val Loss = 2.6081
Epoch 2510: Train Loss = 0.0034, Val Loss = 2.6073
Epoch 2520: Train Loss = 0.0030, Val Loss = 2.6074
Epoch 2530: Train Loss = 0.0028, Val Loss = 2.6074
Epoch 2540: Train Loss = 0.0029, Val Loss = 2.6076
Epoch 2550: Train Loss = 0.0030, Val Loss = 2.6071
Epoch 2560: Train Loss = 0.3710, Val Loss = 2.8193
Epoch 2570: Train Loss = 0.5398, Val Loss = 2.5336
Epoch 2580: Train Loss = 0.3371, Val Loss = 2.7506
Epoch 2590: Train Loss = 0.4357, Val Loss = 2.5496
Epoch 2600: Train Loss = 0.4834, Val Loss = 2.6459
Epoch 2610: Train Loss = 0.5023, Val Loss = 2.6681
Epoch 2620: Train Loss = 0.5138, Val Loss = 2.7658
Epoch 2630: Train Loss = 0.5014, Val Loss = 2.5713
Epoch 2640: Train Loss = 0.4848, Val Loss = 2.6408
Epoch 2650: Train Loss = 0.4916, Val Loss = 2.7330
Epoch 2660: Train Loss = 0.3846, Val Loss = 2.5954
Epoch 2670: Train Loss = 0.3958, Val Loss = 2.5872
Epoch 2680: Train Loss = 0.3681, Val Loss = 2.6774
Epoch 2690: Train Loss = 0.4380, Val Loss = 2.4379
Epoch 2700: Train Loss = 0.3611, Val Loss = 2.5686
Epoch 2710: Train Loss = 0.5204, Val Loss = 2.7527
Epoch 2720: Train Loss = 0.4386, Val Loss = 2.6351
Epoch 2730: Train Loss = 0.4201, Val Loss = 2.5378
Epoch 2740: Train Loss = 0.4324, Val Loss = 2.4087
Epoch 2750: Train Loss = 0.3400, Val Loss = 2.5897
Epoch 2760: Train Loss = 0.4494, Val Loss = 2.4928
Epoch 2770: Train Loss = 0.3531, Val Loss = 2.4517
Epoch 2780: Train Loss = 0.4280, Val Loss = 2.4790
Epoch 2790: Train Loss = 0.3792, Val Loss = 2.5132
Epoch 2800: Train Loss = 0.3625, Val Loss = 2.4942
Epoch 2810: Train Loss = 0.4248, Val Loss = 2.6407
Epoch 2820: Train Loss = 0.5810, Val Loss = 2.5962
Epoch 2830: Train Loss = 0.4236, Val Loss = 2.7440
Epoch 2840: Train Loss = 0.3769, Val Loss = 2.5013
Epoch 2850: Train Loss = 0.4218, Val Loss = 2.5483
Epoch 2860: Train Loss = 0.4075, Val Loss = 2.5824
Epoch 2870: Train Loss = 0.3518, Val Loss = 2.6571
Epoch 2880: Train Loss = 0.3535, Val Loss = 2.6809
Epoch 2890: Train Loss = 0.3656, Val Loss = 2.5912
Epoch 2900: Train Loss = 0.3448, Val Loss = 2.5011
Epoch 2910: Train Loss = 0.4089, Val Loss = 2.5761
Epoch 2920: Train Loss = 0.4739, Val Loss = 2.6588
Epoch 2930: Train Loss = 0.3648, Val Loss = 2.4964
Epoch 2940: Train Loss = 0.3564, Val Loss = 2.5829
Epoch 2950: Train Loss = 0.3422, Val Loss = 2.6363
Epoch 2960: Train Loss = 0.3750, Val Loss = 2.6338
Epoch 2970: Train Loss = 0.4060, Val Loss = 2.5823
Epoch 2980: Train Loss = 0.3838, Val Loss = 2.6276
Epoch 2990: Train Loss = 0.4349, Val Loss = 2.5430
Epoch 3000: Train Loss = 0.3306, Val Loss = 2.6089
