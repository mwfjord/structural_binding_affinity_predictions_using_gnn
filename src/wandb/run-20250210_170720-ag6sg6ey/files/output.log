Using GPU
Regenerating dataset...
Processing...
0it [00:00, ?it/s]
dict_keys(['data_', '_entry.id', '_atom_type.symbol', '_audit_author.name', '_audit_author.pdbx_ordinal', '_audit_conform.dict_location', '_audit_conform.dict_name', '_audit_conform.dict_version', '_chem_comp.formula', '_chem_comp.formula_weight', '_chem_comp.id', '_chem_comp.mon_nstd_flag', '_chem_comp.name', '_chem_comp.pdbx_smiles', '_chem_comp.pdbx_synonyms', '_chem_comp.type', '_citation.book_publisher', '_citation.country', '_citation.id', '_citation.journal_full', '_citation.journal_id_ASTM', '_citation.journal_id_CSD', '_citation.journal_id_ISSN', '_citation.journal_volume', '_citation.page_first', '_citation.page_last', '_citation.pdbx_database_id_DOI', '_citation.pdbx_database_id_PubMed', '_citation.title', '_citation.year', '_citation_author.citation_id', '_citation_author.name', '_citation_author.ordinal', '_entity.id', '_entity.pdbx_description', '_entity.type', '_entity_poly.entity_id', '_entity_poly.pdbx_strand_id', '_entity_poly.type', '_entity_poly_seq.entity_id', '_entity_poly_seq.hetero', '_entity_poly_seq.mon_id', '_entity_poly_seq.num', '_ma_data.content_type', '_ma_data.id', '_ma_data.name', '_ma_model_list.data_id', '_ma_model_list.model_group_id', '_ma_model_list.model_group_name', '_ma_model_list.model_id', '_ma_model_list.model_name', '_ma_model_list.model_type', '_ma_model_list.ordinal_id', '_ma_protocol_step.method_type', '_ma_protocol_step.ordinal_id', '_ma_protocol_step.protocol_id', '_ma_protocol_step.step_id', '_ma_qa_metric.id', '_ma_qa_metric.mode', '_ma_qa_metric.name', '_ma_qa_metric.software_group_id', '_ma_qa_metric.type', '_ma_qa_metric_global.metric_id', '_ma_qa_metric_global.metric_value', '_ma_qa_metric_global.model_id', '_ma_qa_metric_global.ordinal_id', '_ma_software_group.group_id', '_ma_software_group.ordinal_id', '_ma_software_group.software_id', '_ma_target_entity.data_id', '_ma_target_entity.entity_id', '_ma_target_entity.origin', '_ma_target_entity_instance.asym_id', '_ma_target_entity_instance.details', '_ma_target_entity_instance.entity_id', '_pdbx_data_usage.details', '_pdbx_data_usage.id', '_pdbx_data_usage.type', '_pdbx_data_usage.url', '_pdbx_poly_seq_scheme.asym_id', '_pdbx_poly_seq_scheme.auth_seq_num', '_pdbx_poly_seq_scheme.entity_id', '_pdbx_poly_seq_scheme.hetero', '_pdbx_poly_seq_scheme.mon_id', '_pdbx_poly_seq_scheme.pdb_ins_code', '_pdbx_poly_seq_scheme.pdb_seq_num', '_pdbx_poly_seq_scheme.pdb_strand_id', '_pdbx_poly_seq_scheme.seq_id', '_software.classification', '_software.date', '_software.description', '_software.name', '_software.pdbx_ordinal', '_software.type', '_software.version', '_struct_asym.entity_id', '_struct_asym.id', '_atom_site.group_PDB', '_atom_site.id', '_atom_site.type_symbol', '_atom_site.label_atom_id', '_atom_site.label_alt_id', '_atom_site.label_comp_id', '_atom_site.label_asym_id', '_atom_site.label_entity_id', '_atom_site.label_seq_id', '_atom_site.pdbx_PDB_ins_code', '_atom_site.Cartn_x', '_atom_site.Cartn_y', '_atom_site.Cartn_z', '_atom_site.occupancy', '_atom_site.B_iso_or_equiv', '_atom_site.auth_seq_id', '_atom_site.auth_asym_id', '_atom_site.pdbx_PDB_model_num'])
residue d
Atom: d
Traceback (most recent call last):
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/train.py", line 260, in <module>
    main()
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/train.py", line 255, in main
    trainer = Trainer(config, device)
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/train.py", line 55, in __init__
    self.train_dataset = ProteinDNADataset(data_dir, cfg=config)
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/proteinDNADataset.py", line 43, in __init__
    super(ProteinDNADataset, self).__init__(self.root_dir, transform, pre_transform)
  File "/home/marcus/programming/gnn-protein-dna/lib/python3.10/site-packages/torch_geometric/data/dataset.py", line 115, in __init__
    self._process()
  File "/home/marcus/programming/gnn-protein-dna/lib/python3.10/site-packages/torch_geometric/data/dataset.py", line 262, in _process
    self.process()
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/proteinDNADataset.py", line 162, in process
    atom_features, pos = self._get_node_features(structure)
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/proteinDNADataset.py", line 102, in _get_node_features
    atom_site_id = atom["_atomsite.id"]
TypeError: string indices must be integers
Traceback (most recent call last):
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/train.py", line 260, in <module>
    main()
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/train.py", line 255, in main
    trainer = Trainer(config, device)
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/train.py", line 55, in __init__
    self.train_dataset = ProteinDNADataset(data_dir, cfg=config)
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/proteinDNADataset.py", line 43, in __init__
    super(ProteinDNADataset, self).__init__(self.root_dir, transform, pre_transform)
  File "/home/marcus/programming/gnn-protein-dna/lib/python3.10/site-packages/torch_geometric/data/dataset.py", line 115, in __init__
    self._process()
  File "/home/marcus/programming/gnn-protein-dna/lib/python3.10/site-packages/torch_geometric/data/dataset.py", line 262, in _process
    self.process()
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/proteinDNADataset.py", line 162, in process
    atom_features, pos = self._get_node_features(structure)
  File "/home/marcus/programming/structural_binding_affinity_predictions_using_gnn/src/proteinDNADataset.py", line 102, in _get_node_features
    atom_site_id = atom["_atomsite.id"]
TypeError: string indices must be integers
